

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
    <title>test/fixtures/attachment.rb at c4e5b161a43021d107e80e158ed077a5fd65b8cf from jkebinger's attachment_fu - GitHub</title>
    <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="GitHub" />
    <link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub" />

    
      <link href="http://assets1.github.com/stylesheets/bundle.css?a21cbadf91dc6fa5fc9380be41633439f1d1b9e8" media="screen" rel="stylesheet" type="text/css" />
    

    
      
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js"></script>
        <script src="http://assets3.github.com/javascripts/bundle.js?a21cbadf91dc6fa5fc9380be41633439f1d1b9e8" type="text/javascript"></script>
      
    
    
  
    
  

  <link href="http://github.com/feeds/jkebinger/commits/attachment_fu/c4e5b161a43021d107e80e158ed077a5fd65b8cf" rel="alternate" title="Recent Commits to attachment_fu:c4e5b161a43021d107e80e158ed077a5fd65b8cf" type="application/atom+xml" />


    
  </head>

  

  <body>
    

    <div id="main">
      <div id="header" class="">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="/images/modules/header/logo.png" alt="github" /></a>
          </div>
          
            <div class="actions">
              <a href="http://github.com/">Home</a>
              <a href="/plans"><b><u>Pricing and Signup</u></b></a>
              <a href="/repositories">Repositories</a>
              <a href="/guides">Guides</a>
              <a href="/blog">Blog</a>
              <a href="/login">Login</a>
            </div>
          
        </div>
      </div>
      
      
        
  <div id="repo_menu">
    <div class="site">
      <ul>
        
          <li class=""><a href="http://github.com/jkebinger/attachment_fu/tree/">Source</a></li>

          <li class=""><a href="http://github.com/jkebinger/attachment_fu/commits/">Commits</a></li>

          <li class=""><a href="/jkebinger/attachment_fu/graphs">Graphs</a></li>

          <li class=""><a href="http://wiki.github.com/jkebinger/attachment_fu">Wiki (1)</a></li>

          <li class=""><a href="/jkebinger/attachment_fu/watchers">Watchers (3)</a></li>

          <li class=""><a href="/jkebinger/attachment_fu/network">Network (110)</a></li>

          
          
          

        
      </ul>
    </div>
  </div>

  <div id="repo_sub_menu">
    <div class="site">
      <div class="joiner"></div>
      

      
      
      

      
    </div>
  </div>

  <div class="site">
    





<div id="repos">
  




  <div class="repo public">
    <div class="title">
      <div class="path">
        <a href="/jkebinger">jkebinger</a> / <b><a href="http://github.com/jkebinger/attachment_fu/tree">attachment_fu</a></b>

        

          

          
            

            
              
              <a href="/signup"><img alt="fork" class="button" src="http://assets0.github.com/images/modules/repos/fork_button.png?2e5854b45c13954957a3754f82036cd02d7b0d96" /></a>
            
          

          <a href="/signup" class="toggle_watch"><img alt="watch" class="button" src="http://assets0.github.com/images/modules/repos/watch_button.png?2e5854b45c13954957a3754f82036cd02d7b0d96" /></a><a href="/signup" class="toggle_watch" style="display:none;"><img alt="watch" class="button" src="http://assets3.github.com/images/modules/repos/unwatch_button.png?2e5854b45c13954957a3754f82036cd02d7b0d96" /></a>

          
            <a href="#" id="download_button" rel="http://github.com/jkebinger/attachment_fu/downloads/a74ea929dd0d061da887872f8cde07016524dcc4"><img alt="download tarball" class="button" src="http://assets2.github.com/images/modules/repos/download_button.png?2e5854b45c13954957a3754f82036cd02d7b0d96" /></a>
          
        
      </div>

      <div class="security private_security" style="display:none">
        <a href="#private_repo" rel="facebox"><img src="/images/icons/private.png" alt="private" /></a>
      </div>

      <div id="private_repo" class="hidden">
        This repository is private.
        All pages are served over SSL and all pushing and pulling is done over SSH.
        No one may fork, clone, or view it unless they are added as a <a href="/jkebinger/attachment_fu/edit">member</a>.

        <br/>
        <br/>
        Every repository with this icon (<img src="/images/icons/private.png" alt="private" />) is private.
      </div>

      <div class="security public_security" style="">
        <a href="#public_repo" rel="facebox"><img src="/images/icons/public.png" alt="public" /></a>
      </div>

      <div id="public_repo" class="hidden">
        This repository is public.
        Anyone may fork, clone, or view it.

        <br/>
        <br/>
        Every repository with this icon (<img src="/images/icons/public.png" alt="public" />) is public.
      </div>

      
    </div>
    <div class="meta">
      <table>
        
          <tr>
            <td class="label" colspan="2">
              <em>Fork of <a href="/technoweenie/attachment_fu/tree">technoweenie/attachment_fu</a></em>
            </td>
          </tr>
        
        
          <tr>
            <td class="label">Description:</td>
            <td>
              <span id="repository_description" rel="/jkebinger/attachment_fu/edit/update" class="">Treat an ActiveRecord model as a file attachment, storing its patch, size, content type, etc.</span>
              
            </td>
          </tr>
        

        
          
            <tr>
              <td class="label">Homepage:</td>
              <td>
                
                  
                  <a href="http://weblog.techno-weenie.net">http://weblog.techno-weenie.net</a>
                
              </td>
            </tr>
          

          
            <tr>
              <td class="label">Clone&nbsp;URL:</td>
              
              <td>
                <a href="git://github.com/jkebinger/attachment_fu.git" class="git_url_facebox" rel="#git-clone">git://github.com/jkebinger/attachment_fu.git</a>
                <div id="git-clone" style="display:none;">
                  Give this clone URL to anyone.
                  <br/>
                  <code>git clone git://github.com/jkebinger/attachment_fu.git </code>
                </div>
              </td>
            </tr>
          
          
          

          

          
      </table>

          </div>
  </div>




</div>


  <div id="commit">
    <div class="group">
        
  <div class="envelope commit">
    <div class="human">
      
        <div class="message"><pre><a href="/jkebinger/attachment_fu/commit/c4e5b161a43021d107e80e158ed077a5fd65b8cf">remove ruby-debug line. oops</a> </pre></div>
      

      <div class="actor">
        <div class="gravatar">
          
          <img alt="" height="30" src="http://www.gravatar.com/avatar/d57708c7d1b3edf791baf056ed130740?s=30&amp;d=http%3A%2F%2Fgithub.com%2Fimages%2Fgravatars%2Fgravatar-30.png" width="30" />
        </div>
        <div class="name">James Kebinger <span>(author)</span></div>
          <div class="date">
            <abbr class="relatize" title="2008-09-18 14:08:00">Thu Sep 18 14:08:00 -0700 2008</abbr> 
          </div>
      </div>
  
      
  
    </div>
    <div class="machine">
      <span>c</span>ommit&nbsp;&nbsp;<a href="/jkebinger/attachment_fu/commit/c4e5b161a43021d107e80e158ed077a5fd65b8cf" hotkey="c">c4e5b161a43021d107e80e158ed077a5fd65b8cf</a><br />
      <span>t</span>ree&nbsp;&nbsp;&nbsp;&nbsp;<a href="/jkebinger/attachment_fu/tree/c4e5b161a43021d107e80e158ed077a5fd65b8cf/init.rb" hotkey="t">fd37447c6ce02bb78dad677db9ed1617fb02114c</a><br />
  
      
        <span>p</span>arent&nbsp;
        
        <a href="/jkebinger/attachment_fu/commit/b8df48db8b28ec46380de2daaac13c5d3ab5cfeb" hotkey="p">b8df48db8b28ec46380de2daaac13c5d3ab5cfeb</a>
      
  
    </div>
  </div>

    </div>
  </div>





  
    <div id="path">
      <b><a href="/jkebinger/attachment_fu/tree">attachment_fu</a></b> / <a href="/jkebinger/attachment_fu/tree/c4e5b161a43021d107e80e158ed077a5fd65b8cf/test">test</a> / <a href="/jkebinger/attachment_fu/tree/c4e5b161a43021d107e80e158ed077a5fd65b8cf/test/fixtures">fixtures</a> / attachment.rb
    </div>

    <div id="files">
      <div class="file">
        <div class="meta">
          <div class="info">
            <span>100644</span>
            <span>155 lines (130 sloc)</span>
            <span>4.669 kb</span>
          </div>
          <div class="actions">
            
            <a href="/jkebinger/attachment_fu/raw/c4e5b161a43021d107e80e158ed077a5fd65b8cf/test/fixtures/attachment.rb" id="raw-url">raw</a>
            
              <a href="/jkebinger/attachment_fu/blame/c4e5b161a43021d107e80e158ed077a5fd65b8cf/test/fixtures/attachment.rb">blame</a>
            
            <a href="/jkebinger/attachment_fu/commits/master/test/fixtures/attachment.rb">history</a>
          </div>
        </div>
        
  <div class="data syntax">
    
      <table cellpadding="0" cellspacing="0">
        <tr>
          <td>
            
            <pre class="line_numbers">
<span id="LID1" rel="#L1">1</span>
<span id="LID2" rel="#L2">2</span>
<span id="LID3" rel="#L3">3</span>
<span id="LID4" rel="#L4">4</span>
<span id="LID5" rel="#L5">5</span>
<span id="LID6" rel="#L6">6</span>
<span id="LID7" rel="#L7">7</span>
<span id="LID8" rel="#L8">8</span>
<span id="LID9" rel="#L9">9</span>
<span id="LID10" rel="#L10">10</span>
<span id="LID11" rel="#L11">11</span>
<span id="LID12" rel="#L12">12</span>
<span id="LID13" rel="#L13">13</span>
<span id="LID14" rel="#L14">14</span>
<span id="LID15" rel="#L15">15</span>
<span id="LID16" rel="#L16">16</span>
<span id="LID17" rel="#L17">17</span>
<span id="LID18" rel="#L18">18</span>
<span id="LID19" rel="#L19">19</span>
<span id="LID20" rel="#L20">20</span>
<span id="LID21" rel="#L21">21</span>
<span id="LID22" rel="#L22">22</span>
<span id="LID23" rel="#L23">23</span>
<span id="LID24" rel="#L24">24</span>
<span id="LID25" rel="#L25">25</span>
<span id="LID26" rel="#L26">26</span>
<span id="LID27" rel="#L27">27</span>
<span id="LID28" rel="#L28">28</span>
<span id="LID29" rel="#L29">29</span>
<span id="LID30" rel="#L30">30</span>
<span id="LID31" rel="#L31">31</span>
<span id="LID32" rel="#L32">32</span>
<span id="LID33" rel="#L33">33</span>
<span id="LID34" rel="#L34">34</span>
<span id="LID35" rel="#L35">35</span>
<span id="LID36" rel="#L36">36</span>
<span id="LID37" rel="#L37">37</span>
<span id="LID38" rel="#L38">38</span>
<span id="LID39" rel="#L39">39</span>
<span id="LID40" rel="#L40">40</span>
<span id="LID41" rel="#L41">41</span>
<span id="LID42" rel="#L42">42</span>
<span id="LID43" rel="#L43">43</span>
<span id="LID44" rel="#L44">44</span>
<span id="LID45" rel="#L45">45</span>
<span id="LID46" rel="#L46">46</span>
<span id="LID47" rel="#L47">47</span>
<span id="LID48" rel="#L48">48</span>
<span id="LID49" rel="#L49">49</span>
<span id="LID50" rel="#L50">50</span>
<span id="LID51" rel="#L51">51</span>
<span id="LID52" rel="#L52">52</span>
<span id="LID53" rel="#L53">53</span>
<span id="LID54" rel="#L54">54</span>
<span id="LID55" rel="#L55">55</span>
<span id="LID56" rel="#L56">56</span>
<span id="LID57" rel="#L57">57</span>
<span id="LID58" rel="#L58">58</span>
<span id="LID59" rel="#L59">59</span>
<span id="LID60" rel="#L60">60</span>
<span id="LID61" rel="#L61">61</span>
<span id="LID62" rel="#L62">62</span>
<span id="LID63" rel="#L63">63</span>
<span id="LID64" rel="#L64">64</span>
<span id="LID65" rel="#L65">65</span>
<span id="LID66" rel="#L66">66</span>
<span id="LID67" rel="#L67">67</span>
<span id="LID68" rel="#L68">68</span>
<span id="LID69" rel="#L69">69</span>
<span id="LID70" rel="#L70">70</span>
<span id="LID71" rel="#L71">71</span>
<span id="LID72" rel="#L72">72</span>
<span id="LID73" rel="#L73">73</span>
<span id="LID74" rel="#L74">74</span>
<span id="LID75" rel="#L75">75</span>
<span id="LID76" rel="#L76">76</span>
<span id="LID77" rel="#L77">77</span>
<span id="LID78" rel="#L78">78</span>
<span id="LID79" rel="#L79">79</span>
<span id="LID80" rel="#L80">80</span>
<span id="LID81" rel="#L81">81</span>
<span id="LID82" rel="#L82">82</span>
<span id="LID83" rel="#L83">83</span>
<span id="LID84" rel="#L84">84</span>
<span id="LID85" rel="#L85">85</span>
<span id="LID86" rel="#L86">86</span>
<span id="LID87" rel="#L87">87</span>
<span id="LID88" rel="#L88">88</span>
<span id="LID89" rel="#L89">89</span>
<span id="LID90" rel="#L90">90</span>
<span id="LID91" rel="#L91">91</span>
<span id="LID92" rel="#L92">92</span>
<span id="LID93" rel="#L93">93</span>
<span id="LID94" rel="#L94">94</span>
<span id="LID95" rel="#L95">95</span>
<span id="LID96" rel="#L96">96</span>
<span id="LID97" rel="#L97">97</span>
<span id="LID98" rel="#L98">98</span>
<span id="LID99" rel="#L99">99</span>
<span id="LID100" rel="#L100">100</span>
<span id="LID101" rel="#L101">101</span>
<span id="LID102" rel="#L102">102</span>
<span id="LID103" rel="#L103">103</span>
<span id="LID104" rel="#L104">104</span>
<span id="LID105" rel="#L105">105</span>
<span id="LID106" rel="#L106">106</span>
<span id="LID107" rel="#L107">107</span>
<span id="LID108" rel="#L108">108</span>
<span id="LID109" rel="#L109">109</span>
<span id="LID110" rel="#L110">110</span>
<span id="LID111" rel="#L111">111</span>
<span id="LID112" rel="#L112">112</span>
<span id="LID113" rel="#L113">113</span>
<span id="LID114" rel="#L114">114</span>
<span id="LID115" rel="#L115">115</span>
<span id="LID116" rel="#L116">116</span>
<span id="LID117" rel="#L117">117</span>
<span id="LID118" rel="#L118">118</span>
<span id="LID119" rel="#L119">119</span>
<span id="LID120" rel="#L120">120</span>
<span id="LID121" rel="#L121">121</span>
<span id="LID122" rel="#L122">122</span>
<span id="LID123" rel="#L123">123</span>
<span id="LID124" rel="#L124">124</span>
<span id="LID125" rel="#L125">125</span>
<span id="LID126" rel="#L126">126</span>
<span id="LID127" rel="#L127">127</span>
<span id="LID128" rel="#L128">128</span>
<span id="LID129" rel="#L129">129</span>
<span id="LID130" rel="#L130">130</span>
<span id="LID131" rel="#L131">131</span>
<span id="LID132" rel="#L132">132</span>
<span id="LID133" rel="#L133">133</span>
<span id="LID134" rel="#L134">134</span>
<span id="LID135" rel="#L135">135</span>
<span id="LID136" rel="#L136">136</span>
<span id="LID137" rel="#L137">137</span>
<span id="LID138" rel="#L138">138</span>
<span id="LID139" rel="#L139">139</span>
<span id="LID140" rel="#L140">140</span>
<span id="LID141" rel="#L141">141</span>
<span id="LID142" rel="#L142">142</span>
<span id="LID143" rel="#L143">143</span>
<span id="LID144" rel="#L144">144</span>
<span id="LID145" rel="#L145">145</span>
<span id="LID146" rel="#L146">146</span>
<span id="LID147" rel="#L147">147</span>
<span id="LID148" rel="#L148">148</span>
<span id="LID149" rel="#L149">149</span>
<span id="LID150" rel="#L150">150</span>
<span id="LID151" rel="#L151">151</span>
<span id="LID152" rel="#L152">152</span>
<span id="LID153" rel="#L153">153</span>
<span id="LID154" rel="#L154">154</span>
<span id="LID155" rel="#L155">155</span>
</pre>
          </td>
          <td width="100%">
            
            
              <div class="highlight"><pre><div class="line" id="LC1"><span class="k">class</span> <span class="nc">Attachment</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span></div><div class="line" id="LC2">&nbsp;&nbsp;<span class="vc">@@saves</span> <span class="o">=</span> <span class="mi">0</span></div><div class="line" id="LC3">&nbsp;&nbsp;<span class="n">cattr_accessor</span> <span class="ss">:saves</span></div><div class="line" id="LC4">&nbsp;&nbsp;<span class="n">has_attachment</span> <span class="ss">:processor</span> <span class="o">=&gt;</span> <span class="ss">:rmagick</span></div><div class="line" id="LC5">&nbsp;&nbsp;<span class="n">validates_as_attachment</span></div><div class="line" id="LC6">&nbsp;&nbsp;<span class="n">after_attachment_saved</span> <span class="k">do</span> <span class="o">|</span><span class="n">record</span><span class="o">|</span></div><div class="line" id="LC7">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">self</span><span class="o">.</span><span class="n">saves</span> <span class="o">+=</span> <span class="mi">1</span></div><div class="line" id="LC8">&nbsp;&nbsp;<span class="k">end</span></div><div class="line" id="LC9"><span class="k">end</span></div><div class="line" id="LC10">&nbsp;</div><div class="line" id="LC11"><span class="k">class</span> <span class="nc">SmallAttachment</span> <span class="o">&lt;</span> <span class="no">Attachment</span></div><div class="line" id="LC12">&nbsp;&nbsp;<span class="n">has_attachment</span> <span class="ss">:max_size</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="o">.</span><span class="n">kilobyte</span></div><div class="line" id="LC13"><span class="k">end</span></div><div class="line" id="LC14">&nbsp;</div><div class="line" id="LC15"><span class="k">class</span> <span class="nc">BigAttachment</span> <span class="o">&lt;</span> <span class="no">Attachment</span></div><div class="line" id="LC16">&nbsp;&nbsp;<span class="n">has_attachment</span> <span class="ss">:size</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="o">.</span><span class="n">megabyte</span><span class="o">.</span><span class="n">.</span><span class="mi">2</span><span class="o">.</span><span class="n">megabytes</span></div><div class="line" id="LC17"><span class="k">end</span></div><div class="line" id="LC18">&nbsp;</div><div class="line" id="LC19"><span class="k">class</span> <span class="nc">PdfAttachment</span> <span class="o">&lt;</span> <span class="no">Attachment</span></div><div class="line" id="LC20">&nbsp;&nbsp;<span class="n">has_attachment</span> <span class="ss">:content_type</span> <span class="o">=&gt;</span> <span class="s1">&#39;pdf&#39;</span></div><div class="line" id="LC21"><span class="k">end</span></div><div class="line" id="LC22">&nbsp;</div><div class="line" id="LC23"><span class="k">class</span> <span class="nc">PdfWithThumbsAttachment</span> <span class="o">&lt;</span> <span class="no">Attachment</span></div><div class="line" id="LC24">&nbsp;&nbsp;<span class="n">has_attachment</span> <span class="ss">:content_type</span> <span class="o">=&gt;</span> <span class="s1">&#39;pdf&#39;</span><span class="p">,</span> </div><div class="line" id="LC25">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ss">:thumbnails</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:thumb</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="o">]</span><span class="p">},</span></div><div class="line" id="LC26">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ss">:thumbnail_pdf_files</span> <span class="o">=&gt;</span> <span class="kp">true</span></div><div class="line" id="LC27"><span class="k">end</span></div><div class="line" id="LC28">&nbsp;</div><div class="line" id="LC29"><span class="k">class</span> <span class="nc">DocAttachment</span> <span class="o">&lt;</span> <span class="no">Attachment</span></div><div class="line" id="LC30">&nbsp;&nbsp;<span class="n">has_attachment</span> <span class="ss">:content_type</span> <span class="o">=&gt;</span> <span class="sx">%w(pdf doc txt)</span></div><div class="line" id="LC31"><span class="k">end</span></div><div class="line" id="LC32">&nbsp;</div><div class="line" id="LC33"><span class="k">class</span> <span class="nc">ImageAttachment</span> <span class="o">&lt;</span> <span class="no">Attachment</span></div><div class="line" id="LC34">&nbsp;&nbsp;<span class="n">has_attachment</span> <span class="ss">:content_type</span> <span class="o">=&gt;</span> <span class="ss">:image</span><span class="p">,</span> <span class="ss">:resize_to</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="o">]</span></div><div class="line" id="LC35"><span class="k">end</span></div><div class="line" id="LC36">&nbsp;</div><div class="line" id="LC37"><span class="k">class</span> <span class="nc">ImageOrPdfAttachment</span> <span class="o">&lt;</span> <span class="no">Attachment</span></div><div class="line" id="LC38">&nbsp;&nbsp;<span class="n">has_attachment</span> <span class="ss">:content_type</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="ss">:image</span><span class="o">]</span><span class="p">,</span> <span class="ss">:resize_to</span> <span class="o">=&gt;</span> <span class="s1">&#39;x50&#39;</span></div><div class="line" id="LC39"><span class="k">end</span></div><div class="line" id="LC40">&nbsp;</div><div class="line" id="LC41"><span class="k">class</span> <span class="nc">ImageWithThumbsAttachment</span> <span class="o">&lt;</span> <span class="no">Attachment</span></div><div class="line" id="LC42">&nbsp;&nbsp;<span class="n">has_attachment</span> <span class="ss">:thumbnails</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:thumb</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="o">]</span><span class="p">,</span> <span class="ss">:geometry</span> <span class="o">=&gt;</span> <span class="s1">&#39;x50&#39;</span> <span class="p">},</span> <span class="ss">:resize_to</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="mi">55</span><span class="p">,</span><span class="mi">55</span><span class="o">]</span></div><div class="line" id="LC43">&nbsp;&nbsp;<span class="n">after_resize</span> <span class="k">do</span> <span class="o">|</span><span class="n">record</span><span class="p">,</span> <span class="n">img</span><span class="o">|</span></div><div class="line" id="LC44">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">record</span><span class="o">.</span><span class="n">aspect_ratio</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_f</span> <span class="o">/</span> <span class="n">img</span><span class="o">.</span><span class="n">rows</span><span class="o">.</span><span class="n">to_f</span></div><div class="line" id="LC45">&nbsp;&nbsp;<span class="k">end</span></div><div class="line" id="LC46"><span class="k">end</span></div><div class="line" id="LC47">&nbsp;</div><div class="line" id="LC48"><span class="k">class</span> <span class="nc">FileAttachment</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span></div><div class="line" id="LC49">&nbsp;&nbsp;<span class="n">has_attachment</span> <span class="ss">:path_prefix</span> <span class="o">=&gt;</span> <span class="s1">&#39;vendor/plugins/attachment_fu/test/files&#39;</span><span class="p">,</span> <span class="ss">:processor</span> <span class="o">=&gt;</span> <span class="ss">:rmagick</span></div><div class="line" id="LC50">&nbsp;&nbsp;<span class="n">validates_as_attachment</span></div><div class="line" id="LC51"><span class="k">end</span></div><div class="line" id="LC52">&nbsp;</div><div class="line" id="LC53"><span class="k">class</span> <span class="nc">ImageFileAttachment</span> <span class="o">&lt;</span> <span class="no">FileAttachment</span></div><div class="line" id="LC54">&nbsp;&nbsp;<span class="n">has_attachment</span> <span class="ss">:path_prefix</span> <span class="o">=&gt;</span> <span class="s1">&#39;vendor/plugins/attachment_fu/test/files&#39;</span><span class="p">,</span></div><div class="line" id="LC55">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ss">:content_type</span> <span class="o">=&gt;</span> <span class="ss">:image</span><span class="p">,</span> <span class="ss">:resize_to</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="o">]</span></div><div class="line" id="LC56"><span class="k">end</span></div><div class="line" id="LC57">&nbsp;</div><div class="line" id="LC58"><span class="k">class</span> <span class="nc">ImageWithThumbsFileAttachment</span> <span class="o">&lt;</span> <span class="no">FileAttachment</span></div><div class="line" id="LC59">&nbsp;&nbsp;<span class="n">has_attachment</span> <span class="ss">:path_prefix</span> <span class="o">=&gt;</span> <span class="s1">&#39;vendor/plugins/attachment_fu/test/files&#39;</span><span class="p">,</span></div><div class="line" id="LC60">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ss">:thumbnails</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:thumb</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="o">]</span><span class="p">,</span> <span class="ss">:geometry</span> <span class="o">=&gt;</span> <span class="s1">&#39;x50&#39;</span> <span class="p">},</span> <span class="ss">:resize_to</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="mi">55</span><span class="p">,</span><span class="mi">55</span><span class="o">]</span></div><div class="line" id="LC61">&nbsp;&nbsp;<span class="n">after_resize</span> <span class="k">do</span> <span class="o">|</span><span class="n">record</span><span class="p">,</span> <span class="n">img</span><span class="o">|</span></div><div class="line" id="LC62">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">record</span><span class="o">.</span><span class="n">aspect_ratio</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_f</span> <span class="o">/</span> <span class="n">img</span><span class="o">.</span><span class="n">rows</span><span class="o">.</span><span class="n">to_f</span></div><div class="line" id="LC63">&nbsp;&nbsp;<span class="k">end</span></div><div class="line" id="LC64"><span class="k">end</span></div><div class="line" id="LC65">&nbsp;</div><div class="line" id="LC66"><span class="k">class</span> <span class="nc">ImageWithThumbsClassFileAttachment</span> <span class="o">&lt;</span> <span class="no">FileAttachment</span></div><div class="line" id="LC67">&nbsp;&nbsp;<span class="c1"># use file_system_path to test backwards compatibility</span></div><div class="line" id="LC68">&nbsp;&nbsp;<span class="n">has_attachment</span> <span class="ss">:file_system_path</span> <span class="o">=&gt;</span> <span class="s1">&#39;vendor/plugins/attachment_fu/test/files&#39;</span><span class="p">,</span></div><div class="line" id="LC69">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ss">:thumbnails</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:thumb</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="o">]</span> <span class="p">},</span> <span class="ss">:resize_to</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="mi">55</span><span class="p">,</span><span class="mi">55</span><span class="o">]</span><span class="p">,</span></div><div class="line" id="LC70">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ss">:thumbnail_class</span> <span class="o">=&gt;</span> <span class="s1">&#39;ImageThumbnail&#39;</span></div><div class="line" id="LC71"><span class="k">end</span></div><div class="line" id="LC72">&nbsp;</div><div class="line" id="LC73"><span class="k">class</span> <span class="nc">ImageThumbnail</span> <span class="o">&lt;</span> <span class="no">FileAttachment</span></div><div class="line" id="LC74">&nbsp;&nbsp;<span class="n">has_attachment</span> <span class="ss">:path_prefix</span> <span class="o">=&gt;</span> <span class="s1">&#39;vendor/plugins/attachment_fu/test/files/thumbnails&#39;</span></div><div class="line" id="LC75"><span class="k">end</span></div><div class="line" id="LC76">&nbsp;</div><div class="line" id="LC77"><span class="c1"># no parent</span></div><div class="line" id="LC78"><span class="k">class</span> <span class="nc">OrphanAttachment</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span></div><div class="line" id="LC79">&nbsp;&nbsp;<span class="n">has_attachment</span> <span class="ss">:processor</span> <span class="o">=&gt;</span> <span class="ss">:rmagick</span></div><div class="line" id="LC80">&nbsp;&nbsp;<span class="n">validates_as_attachment</span></div><div class="line" id="LC81"><span class="k">end</span></div><div class="line" id="LC82">&nbsp;</div><div class="line" id="LC83"><span class="c1"># no filename, no size, no content_type</span></div><div class="line" id="LC84"><span class="k">class</span> <span class="nc">MinimalAttachment</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span></div><div class="line" id="LC85">&nbsp;&nbsp;<span class="n">has_attachment</span> <span class="ss">:path_prefix</span> <span class="o">=&gt;</span> <span class="s1">&#39;vendor/plugins/attachment_fu/test/files&#39;</span><span class="p">,</span> <span class="ss">:processor</span> <span class="o">=&gt;</span> <span class="ss">:rmagick</span></div><div class="line" id="LC86">&nbsp;&nbsp;<span class="n">validates_as_attachment</span></div><div class="line" id="LC87">&nbsp;&nbsp;</div><div class="line" id="LC88">&nbsp;&nbsp;<span class="k">def</span> <span class="nf">filename</span></div><div class="line" id="LC89">&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&quot;</span><span class="si">#{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.file&quot;</span></div><div class="line" id="LC90">&nbsp;&nbsp;<span class="k">end</span></div><div class="line" id="LC91"><span class="k">end</span></div><div class="line" id="LC92">&nbsp;</div><div class="line" id="LC93"><span class="k">begin</span></div><div class="line" id="LC94">&nbsp;&nbsp;<span class="k">class</span> <span class="nc">ImageScienceAttachment</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span></div><div class="line" id="LC95">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">has_attachment</span> <span class="ss">:path_prefix</span> <span class="o">=&gt;</span> <span class="s1">&#39;vendor/plugins/attachment_fu/test/files&#39;</span><span class="p">,</span></div><div class="line" id="LC96">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ss">:processor</span> <span class="o">=&gt;</span> <span class="ss">:image_science</span><span class="p">,</span> <span class="ss">:thumbnails</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:thumb</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">51</span><span class="o">]</span><span class="p">,</span> <span class="ss">:geometry</span> <span class="o">=&gt;</span> <span class="s1">&#39;31&gt;&#39;</span> <span class="p">},</span> <span class="ss">:resize_to</span> <span class="o">=&gt;</span> <span class="mi">55</span></div><div class="line" id="LC97">&nbsp;&nbsp;<span class="k">end</span></div><div class="line" id="LC98"><span class="k">rescue</span> <span class="no">MissingSourceFile</span></div><div class="line" id="LC99">&nbsp;&nbsp;<span class="nb">puts</span> <span class="vg">$!</span><span class="o">.</span><span class="n">message</span></div><div class="line" id="LC100">&nbsp;&nbsp;<span class="nb">puts</span> <span class="s2">&quot;no ImageScience&quot;</span></div><div class="line" id="LC101"><span class="k">end</span></div><div class="line" id="LC102">&nbsp;</div><div class="line" id="LC103"><span class="k">begin</span></div><div class="line" id="LC104">&nbsp;&nbsp;<span class="k">class</span> <span class="nc">CoreImageAttachment</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span></div><div class="line" id="LC105">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">has_attachment</span> <span class="ss">:path_prefix</span> <span class="o">=&gt;</span> <span class="s1">&#39;vendor/plugins/attachment_fu/test/files&#39;</span><span class="p">,</span></div><div class="line" id="LC106">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ss">:processor</span> <span class="o">=&gt;</span> <span class="ss">:core_image</span><span class="p">,</span> <span class="ss">:thumbnails</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:thumb</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">51</span><span class="o">]</span><span class="p">,</span> <span class="ss">:geometry</span> <span class="o">=&gt;</span> <span class="s1">&#39;31&gt;&#39;</span> <span class="p">},</span> <span class="ss">:resize_to</span> <span class="o">=&gt;</span> <span class="mi">55</span></div><div class="line" id="LC107">&nbsp;&nbsp;<span class="k">end</span></div><div class="line" id="LC108"><span class="k">rescue</span> <span class="no">MissingSourceFile</span></div><div class="line" id="LC109">&nbsp;&nbsp;<span class="nb">puts</span> <span class="vg">$!</span><span class="o">.</span><span class="n">message</span></div><div class="line" id="LC110">&nbsp;&nbsp;<span class="nb">puts</span> <span class="s2">&quot;no CoreImage&quot;</span></div><div class="line" id="LC111"><span class="k">end</span></div><div class="line" id="LC112">&nbsp;</div><div class="line" id="LC113"><span class="k">begin</span></div><div class="line" id="LC114">&nbsp;&nbsp;<span class="k">class</span> <span class="nc">MiniMagickAttachment</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span></div><div class="line" id="LC115">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">has_attachment</span> <span class="ss">:path_prefix</span> <span class="o">=&gt;</span> <span class="s1">&#39;vendor/plugins/attachment_fu/test/files&#39;</span><span class="p">,</span></div><div class="line" id="LC116">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ss">:processor</span> <span class="o">=&gt;</span> <span class="ss">:mini_magick</span><span class="p">,</span> <span class="ss">:thumbnails</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:thumb</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">51</span><span class="o">]</span><span class="p">,</span> <span class="ss">:geometry</span> <span class="o">=&gt;</span> <span class="s1">&#39;31&gt;&#39;</span> <span class="p">},</span> <span class="ss">:resize_to</span> <span class="o">=&gt;</span> <span class="mi">55</span></div><div class="line" id="LC117">&nbsp;&nbsp;<span class="k">end</span></div><div class="line" id="LC118"><span class="k">rescue</span> <span class="no">MissingSourceFile</span></div><div class="line" id="LC119">&nbsp;&nbsp;<span class="nb">puts</span> <span class="vg">$!</span><span class="o">.</span><span class="n">message</span></div><div class="line" id="LC120">&nbsp;&nbsp;<span class="nb">puts</span> <span class="s2">&quot;no Mini Magick&quot;</span></div><div class="line" id="LC121"><span class="k">end</span></div><div class="line" id="LC122">&nbsp;</div><div class="line" id="LC123"><span class="k">begin</span></div><div class="line" id="LC124">&nbsp;&nbsp;<span class="k">class</span> <span class="nc">GD2Attachment</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span></div><div class="line" id="LC125">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">has_attachment</span> <span class="ss">:path_prefix</span> <span class="o">=&gt;</span> <span class="s1">&#39;vendor/plugins/attachment_fu/test/files&#39;</span><span class="p">,</span></div><div class="line" id="LC126">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ss">:processor</span> <span class="o">=&gt;</span> <span class="ss">:gd2</span><span class="p">,</span> <span class="ss">:thumbnails</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:thumb</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">51</span><span class="o">]</span><span class="p">,</span> <span class="ss">:geometry</span> <span class="o">=&gt;</span> <span class="s1">&#39;31&gt;&#39;</span> <span class="p">},</span> <span class="ss">:resize_to</span> <span class="o">=&gt;</span> <span class="mi">55</span></div><div class="line" id="LC127">&nbsp;&nbsp;<span class="k">end</span></div><div class="line" id="LC128"><span class="k">rescue</span> <span class="no">MissingSourceFile</span></div><div class="line" id="LC129">&nbsp;&nbsp;<span class="nb">puts</span> <span class="vg">$!</span><span class="o">.</span><span class="n">message</span></div><div class="line" id="LC130">&nbsp;&nbsp;<span class="nb">puts</span> <span class="s2">&quot;no GD2&quot;</span></div><div class="line" id="LC131"><span class="k">end</span></div><div class="line" id="LC132">&nbsp;</div><div class="line" id="LC133">&nbsp;</div><div class="line" id="LC134"><span class="k">begin</span></div><div class="line" id="LC135">&nbsp;&nbsp;<span class="k">class</span> <span class="nc">MiniMagickAttachment</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span></div><div class="line" id="LC136">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">has_attachment</span> <span class="ss">:path_prefix</span> <span class="o">=&gt;</span> <span class="s1">&#39;vendor/plugins/attachment_fu/test/files&#39;</span><span class="p">,</span></div><div class="line" id="LC137">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ss">:processor</span> <span class="o">=&gt;</span> <span class="ss">:mini_magick</span><span class="p">,</span> <span class="ss">:thumbnails</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:thumb</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">51</span><span class="o">]</span><span class="p">,</span> <span class="ss">:geometry</span> <span class="o">=&gt;</span> <span class="s1">&#39;31&gt;&#39;</span> <span class="p">},</span> <span class="ss">:resize_to</span> <span class="o">=&gt;</span> <span class="mi">55</span></div><div class="line" id="LC138">&nbsp;&nbsp;<span class="k">end</span></div><div class="line" id="LC139"><span class="k">rescue</span> <span class="no">MissingSourceFile</span></div><div class="line" id="LC140"><span class="k">end</span></div><div class="line" id="LC141">&nbsp;</div><div class="line" id="LC142"><span class="k">begin</span></div><div class="line" id="LC143">&nbsp;&nbsp;<span class="k">class</span> <span class="nc">S3Attachment</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span></div><div class="line" id="LC144">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">has_attachment</span> <span class="ss">:storage</span> <span class="o">=&gt;</span> <span class="ss">:s3</span><span class="p">,</span> <span class="ss">:processor</span> <span class="o">=&gt;</span> <span class="ss">:rmagick</span><span class="p">,</span> <span class="ss">:s3_config_path</span> <span class="o">=&gt;</span> <span class="no">File</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="no">File</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">__FILE__</span><span class="p">),</span> <span class="s1">&#39;../amazon_s3.yml&#39;</span><span class="p">)</span></div><div class="line" id="LC145">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">validates_as_attachment</span></div><div class="line" id="LC146">&nbsp;&nbsp;<span class="k">end</span></div><div class="line" id="LC147">&nbsp;</div><div class="line" id="LC148">&nbsp;&nbsp;<span class="k">class</span> <span class="nc">S3WithPathPrefixAttachment</span> <span class="o">&lt;</span> <span class="no">S3Attachment</span></div><div class="line" id="LC149">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">has_attachment</span> <span class="ss">:storage</span> <span class="o">=&gt;</span> <span class="ss">:s3</span><span class="p">,</span> <span class="ss">:path_prefix</span> <span class="o">=&gt;</span> <span class="s1">&#39;some/custom/path/prefix&#39;</span><span class="p">,</span> <span class="ss">:processor</span> <span class="o">=&gt;</span> <span class="ss">:rmagick</span></div><div class="line" id="LC150">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">validates_as_attachment</span></div><div class="line" id="LC151">&nbsp;&nbsp;<span class="k">end</span></div><div class="line" id="LC152"><span class="k">rescue</span></div><div class="line" id="LC153">&nbsp;&nbsp;<span class="nb">puts</span> <span class="s2">&quot;S3 error: </span><span class="si">#{</span><span class="vg">$!</span><span class="si">}</span><span class="s2">&quot;</span></div><div class="line" id="LC154"><span class="k">end</span></div><div class="line" id="LC155">&nbsp;</div></pre></div>
            
          </td>
        </tr>
      </table>
    
  </div>


      </div>
    </div>
    
  


  </div>

      
      
      <div class="push"></div>
    </div>
    
    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">T-Shirts</a> |            
            <a href="http://github.com/blog">Blog</a> |             
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Git Training</a> | 
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> | 
            <a href="http://github.wordpress.com">Status</a> 
          </div>
          <div class="company">
            <span id="_rrt" title="0.03498s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> &copy;2009 | <a href="/site/terms">Terms of Service</a> | <a href="/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com"><img src="/images/modules/footer/engine_yard_logo.png" alt="Engine Yard" /></a>
          <div>
            Hosting provided by our<br /> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display:none;">
      This feature is coming soon.  Sit tight!
    </div>

    
        <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    var pageTracker = _gat._getTracker("UA-3769691-2");
    pageTracker._initData();
    pageTracker._trackPageview();
    </script>

  </body>
</html>

