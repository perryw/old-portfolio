<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"    
 "http://www.w3.org/TR/html4/strict.dtd"> 

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta http-equiv="content-type" content="text/html;charset=UTF-8" />
	<title><%= APP_CONFIG['settings']['name'] %>: <%= controller.action_name %></title>
	<!--%= stylesheet_link_tag 'Jash' %-->
	<!--%= javascript_include_tag 'Jash' %-->
	
	<%= stylesheet_link_tag 'reset' %>
	<%= stylesheet_link_tag 'fonts' %>
	<%= stylesheet_link_tag 'grids' %>
	<%= stylesheet_link_tag 'base' %>
	<%= stylesheet_link_tag 'main' %>
	
	<%= stylesheet_link_tag 'scaffold' %>
	<%= stylesheet_link_tag 'gallery' %>
	<%= stylesheet_link_tag 'menu' %>
	<%= stylesheet_link_tag 'breadcrumb' %>
	<%= stylesheet_link_tag 'lightview' %>
</head>
<body>
	<div class='loading-container'><span id="loading">Loading CSS</span></div>
	<%= javascript_tag 'var divtag=document.getElementById("loading"); divtag.innerHTML="Loading prototype...";' %>
	<%= javascript_include_tag 'prototype' %>
	
	<%= javascript_tag '$("loading").innerHTML="Now setting javascript variables...";' %>
	<%= javascript_tag "var AUTH_TOKEN = #{form_authenticity_token.inspect};" if protect_against_forgery? %>
	<%= javascript_tag "var CURR_CRUMB = #{session['breadcrumb_index']};"%>
			
	<%= javascript_tag '$("loading").innerHTML= "Loading script.aculo.us...";' %>
	<%= javascript_include_tag 'scriptaculous'  %>
	<%= javascript_include_tag :defaults %>
	
	<%= javascript_tag '$("loading").innerHTML="Loading Lightview files...";' %>
	<%= javascript_include_tag 'lightview' %>
	
	<%= javascript_tag '$("loading").innerHTML="Adding observers for Lightview buttons & utility functions...";' %>
	<%= javascript_include_tag 'wyrrep_utility' %>
	
	<%= javascript_tag '$("loading").innerHTML="Adding support for in-place edit...";' %>
	<%= javascript_include_tag 'inplaceeditor_empty.js' %>

	<div id="main" class="yui-d2f"><!-- start YUI layout -->
		<!--div class='bl'><div class='br'><div class='tl'><div class='tr'-->
		<div id="hd"><!-- header -->
	    	<div class="yui-gd"> <!-- the "special grid" --> 
	    		<div class="yui-u first">
	    			<span><%=link_to image_tag('header_invis_img.png'), '/', :id => 'invis'%></span>
					<h1><%= APP_CONFIG['settings']['name'] %></h1>
					<p><%= APP_CONFIG['settings']['tagline'] %></p>
				</div> 
	    	</div> 
    		<div class="yui-u user_bar">
				<%= render :partial => "shared/user_bar" %>
			</div> 
			<!--div id="navigation_container"-->
			<div id="menu_container">
				<%# ubermenu :id => 'main_navigation' do |m| %>
				<% ubermenu :id => 'blue', :class=>'menu' do |m| %>
			  		<% m.action 'Homepage', root_path %>
					<% #if_logged_in? do %>
                        <!--% m.action 'Members', members_path, :class => 'menu_admin' %-->
						<!--% m.remote_action 'Collaborators', {
								:url => {
									:controller => 'collaborators',
									:action => 'index'
								},
								:method => :get,
								:update => 'p_page',
								:loading => "$('spinner_div').show()",
								:complete => "$('spinner_div').hide(); updateCurrMenuItem('menu_collaborators'); document.fire('jsviz:clicked')"
							},
							{	:id => 'menu_collaborators', :href => url_for(:controller => "collaborators", :action => "index") }
						 %-->
						<% m.remote_action "Courses", {
					    		:url=>{
					        		:controller=>'courses',
					        		:action=>'index'
								}, 
								:method => :get,
								:update => 'p_page',
								:loading => "$('spinner_div').show()",
								:complete => "$('spinner_div').hide(); updateCurrMenuItem('menu_courses'); document.fire('jsviz:clicked')"
							},
							{	:id => 'menu_courses', :href => url_for(:controller => "courses", :action => "index") }
						 %>
            <% if logged_in? -%>
   						<% m.remote_action 'Projects', {
  								:url => {
  									:controller => 'projects',
  									:action => 'index'
                  },
  								:method => :get,
  								:update => 'p_page',
  								:loading => "$('spinner_div').show()",
  								:complete => "$('spinner_div').hide(); updateCurrMenuItem('menu_projects'); loadSpotLights(); document.fire('jsviz:clicked')"
  							},
                {	:id => 'menu_projects', :href => url_for(:controller => "projects", :action => "index")	}
  						 %>
              <% else -%>
     						<% m.remote_action 'Projects', {
  								:url => {
  									:controller => 'gallery',
  									:action => 'projects'
                  },
  								:method => :get,
  								:update => 'p_page',
  								:loading => "$('spinner_div').show()",
  								:complete => "$('spinner_div').hide(); updateCurrMenuItem('menu_projects'); loadSpotLights(); document.fire('jsviz:clicked')"
  							},
                {	:id => 'menu_projects', :href => url_for(:controller => "gallery", :action => "projects")	}
  						 %>
            <% end -%>
            <% if logged_in? -%>
  						<% m.remote_action 'Deliverables', {
  								:url => {
  									:controller => 'deliverables',
  									:action => 'index'
                  },
  								:method => :get,
  								:update => 'p_page',
  								:loading => "$('spinner_div').show()",
  								:complete => "$('spinner_div').hide(); updateCurrMenuItem('menu_deliverables'); loadSpotLights(); document.fire('jsviz:clicked')"
  							},
                {	:id => 'menu_deliverables', :href => url_for(:controller=>"deliverables", :action => "index")}
  						 %>
            <% else -%>
  						<% m.remote_action 'Deliverables', {
  								:url => {
  									:controller => 'gallery',
  									:action => 'deliverables'
                  },
  								:method => :get,
  								:update => 'p_page',
  								:loading => "$('spinner_div').show()",
  								:complete => "$('spinner_div').hide(); updateCurrMenuItem('menu_deliverables'); loadSpotLights(); document.fire('jsviz:clicked')"
  							},
                {	:id => 'menu_deliverables', :href => url_for(:controller=>"gallery", :action => "deliverables")}
							%>
            <% end -%>
						<% m.remote_action 'Gallery', {
								:url => {
									:controller => 'gallery',
									:action => 'index'
								},
								:method => :get,
								:update => 'p_page',
								:loading => "$('spinner_div').show()",
								:complete => "$('spinner_div').hide(); copyGalleryTagClouds(); updateCurrMenuItem('menu_gallery'); Lightview.updateViews(); document.fire('jsviz:clicked'); loadSpotLights()"
							},
							{	:id => 'menu_gallery', :href => url_for(:controller => "gallery", :action => "index") }
						 %>
						<% m.remote_action 'Resources', {
								:url => {
									:controller => 'resources',
									:action => 'index'
								},
								:method => :get,
								:update => 'p_page',
								:loading => "$('spinner_div').show()",
								:complete => "$('spinner_div').hide(); updateCurrMenuItem('menu_resources'); document.fire('jsviz:clicked')"
							},
							{	:id => 'menu_resources', :href => url_for(:controller => "resources", :action => "index") }
						%>								
					<% #end %>
		    	<% if_admin? do %>
          	<%# m.action 'Admin', admin_controls_path, :class => 'menu_admin' %>
					<% end %>
				<% end %>
			</div>
			<div id='rails_messages'>
				<%= flash_messages %>
			</div>
		</div>
		<!--/div></div></div></div-->
		
		<div id="bd"><!-- body -->
			<%= render :partial => "layouts/#{controller.nested_layout}" %>
		</div>  

		<div id="ft"><!-- footer -->
			<p>Copyright 2008-2009 Wyrrep.com</p>
		</div>  	
  
	</div><!-- end YUI layout -->
  
	<!-- debug -->
	<% if true || Rails.env == "development" %>
	  <div id="footnotes_holder">
	  </div>
	  <%= render :partial => 'shared/debug' %>
	<% end %>

</body>
</html>
