<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"    
 "http://www.w3.org/TR/html4/strict.dtd"> 

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta http-equiv="content-type" content="text/html;charset=UTF-8" />
	<title><%= APP_CONFIG['settings']['name'] %>: <%= controller.action_name %></title>
	<div id="loading">Loading CSS</div>
	<%= stylesheet_link_tag 'reset' %>
	<%= stylesheet_link_tag 'fonts' %>
	<%= stylesheet_link_tag 'grids' %>
	<%= stylesheet_link_tag 'base' %>
	<%= stylesheet_link_tag 'main' %>
	
	<%= stylesheet_link_tag 'scaffold' %>
	<%= stylesheet_link_tag 'gallery' %>
	<%= stylesheet_link_tag 'menu' %>
	<%= stylesheet_link_tag 'breadcrumb' %>
	<%= stylesheet_link_tag 'lightview2_4' %>
	
	<%= javascript_tag 'var divtag=document.getElementById("loading"); divtag.innerHTML="Loading prototype...";' %>
	<%= javascript_include_tag 'prototype' %>
	
	<%= javascript_tag '$("loading").innerHTML="Now setting javascript variables...";' %>
	<%= javascript_tag "var AUTH_TOKEN = #{form_authenticity_token.inspect};" if protect_against_forgery? %>
	<%= javascript_tag "var CURR_CRUMB = #{session['breadcrumb_index']};"%>
			
	<%= javascript_tag '$("loading").innerHTML= "Loading script.aculo.us...";' %>
	<%= javascript_include_tag 'scriptaculous'  %>
	<%= javascript_include_tag :defaults %>
	
	<%= javascript_tag '$("loading").innerHTML="Loading Lightview files...";' %>
	<%= javascript_include_tag 'lightview2_4' %>
	
	<%= javascript_tag '$("loading").innerHTML="Adding observers for Lightview buttons & utility functions...";' %>
	<%= javascript_include_tag 'wyrrep_utility' %>
	
	<%= javascript_tag '$("loading").innerHTML="Adding support for in-place edit...";' %>
	<%= javascript_include_tag 'inplaceeditor_empty.js' %>
</head>
<body>
	<div id="main" class="yui-d2f"><!-- start YUI layout -->

		<div id="hd"><!-- header -->
			<span></span>
	    	<div class="yui-gd"> <!-- the "special grid" --> 
	    		<div class="yui-u first">
					<h1><%= APP_CONFIG['settings']['name'] %></h1>
					<p><%= APP_CONFIG['settings']['tagline'] %></p>
				</div> 
	    		<div class="yui-u">
					<%= render :partial => "shared/user_bar" %>
				</div> 
	    	</div> 
			<!--div id="navigation_container"-->
			<div id="menu_container">
				<%# ubermenu :id => 'main_navigation' do |m| %>
				<% ubermenu :id => 'blue', :class=>'menu' do |m| %>
			  		<% m.action 'Homepage', root_path %>
					<% if_logged_in? do %>
                        <% m.action 'Members', members_path, :class => 'menu_admin' %>
						<% m.remote_action 'Collaborators', {
								:url => {
									:controller => 'collaborators',
									:action => 'index'
								},
								:method => :get,
								:update => 'p_page',
								:loading => "$('spinner_div').show()",
								:complete => "$('spinner_div').hide(); updateCurrMenuItem('menu_collaborators'); document.fire('jsviz:clicked')"
							},
							{	:id => 'menu_collaborators', :href => url_for(:controller => "collaborators", :action => "index") }
						 %>
						<% m.remote_action "Courses", {
					    		:url=>{
					        		:controller=>'courses',
					        		:action=>'index'
								}, 
								:method => :get,
								:update => 'p_page',
								:loading => "$('spinner_div').show()",
								:complete => "$('spinner_div').hide(); updateCurrMenuItem('menu_courses'); document.fire('jsviz:clicked')"
							},
							{	:id => 'menu_courses', :href => url_for(:controller => "courses", :action => "index") }
						 %>
 						<% m.remote_action 'Projects', {
								:url => {
									:controller => 'projects',
									:action => 'index'
								},
								:method => :get,
								:update => 'p_page',
								:loading => "$('spinner_div').show()",
								:complete => "$('spinner_div').hide(); updateCurrMenuItem('menu_projects'); document.fire('jsviz:clicked')"
							},
							{	:id => 'menu_projects', :href => url_for(:controller => "projects", :action => "index")	}
						 %>
						<% m.remote_action 'Deliverables', {
								:url => {
									:controller => 'deliverables',
									:action => 'index'
								},
								:method => :get,
								:update => 'p_page',
								:loading => "$('spinner_div').show()",
								:complete => "$('spinner_div').hide(); updateCurrMenuItem('menu_deliverables'); document.fire('jsviz:clicked')"
							},
							{	:id => 'menu_deliverables', :href => url_for(:controller=>"deliverables", :action => "index") }
						 %>
						<% m.remote_action 'Gallery', {
								:url => {
									:controller => 'gallery',
									:action => 'index'
								},
								:method => :get,
								:update => 'p_page',
								:loading => "$('spinner_div').show()",
								:complete => "$('spinner_div').hide(); updateCurrMenuItem('menu_gallery'); Lightview.updateViews(); document.fire('jsviz:clicked')"
							},
							{	:id => 'menu_gallery', :href => url_for(:controller => "gallery", :action => "index") }
						 %>
						<% m.remote_action 'Resources', {
								:url => {
									:controller => 'resources',
									:action => 'index'
								},
								:method => :get,
								:update => 'p_page',
								:loading => "$('spinner_div').show()",
								:complete => "$('spinner_div').hide(); updateCurrMenuItem('menu_resources'); document.fire('jsviz:clicked')"
							},
							{	:id => 'menu_resources', :href => url_for(:controller => "resources", :action => "index") }
						%>								
					<% end %>
			    	<% if_admin? do %>
                    	<% m.action 'Admin', admin_controls_path, :class => 'menu_admin' %>
					<% end %>
				<% end %>
			</div>
			<div id='rails_messages'>
				<%= flash_messages %>
			</div>
		</div>

		<div id="bd"><!-- body -->
			<%= render :partial => "layouts/#{controller.nested_layout}" %>
		</div>  

		<div id="ft"><!-- footer -->
			<p>Copyright 2008 Your Company</p>
		</div>  	
  
	</div><!-- end YUI layout -->
  
	<!-- debug -->
	<% if true || Rails.env == "development" %>
	  <div id="footnotes_holder">
	  </div>
	  <%= render :partial => 'shared/debug' %>
	<% end %>

</body>
</html>
